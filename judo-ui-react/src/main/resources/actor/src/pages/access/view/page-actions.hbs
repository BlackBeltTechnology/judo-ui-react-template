import { useCallback } from 'react';
import { useTranslation } from 'react-i18next';
import { Button, Grid } from '@mui/material';
import { LoadingButton } from '@mui/lab';
import { MdiIcon, useJudoNavigation } from '~/components';
import { useConfirmDialog } from '~/components/dialog';
import {
    {{ classDataName page.dataElement.target 'Stored' }},
} from '~/generated/data-api';
import {
    {{# each (getOnlyPageActions page) as |action| }}
        {{ actionFunctionHookName action }},
    {{/ each }}
} from '../actions';

export interface PageActionsProps {
    data: {{ classDataName page.dataElement.target 'Stored' }};
    editMode: boolean;
    setEditMode: (mode: boolean) => void;
    isLoading: boolean;
    fetchData: () => Promise<void>;
    {{# if page.dataElement.isUpdatable }}
        saveData: () => Promise<void>;
    {{/ if }}
    {{# if page.dataElement.isDeletable }}
        deleteData: () => Promise<void>;
    {{/ if }}
}

export function PageActions (props: PageActionsProps) {
    const { data, editMode, setEditMode, isLoading, fetchData{{# if page.dataElement.isUpdatable }}, saveData{{/ if }}{{# if page.dataElement.isDeletable }}, deleteData{{/ if }} } = props;
    const { t } = useTranslation();
    const { navigate, back } = useJudoNavigation();
    const { openConfirmDialog } = useConfirmDialog();

    {{# each (getOnlyPageActions page) as |action| }}
        const {{ actionFunctionName action }} = {{ actionFunctionHookName action }}();
    {{/ each }}

    {{# if isDebugPrint }}// include: actor/src/fragments/page/mapped-form-flags.hbs{{/ if }}
    {{> actor/src/fragments/page/mapped-form-flags.hbs }}

    return (
        <>
            {{# if isDebugPrint }}{/* include: actor/src/fragments/page/page-crud-actions.hbs */}{{/ if }}
            {{> actor/src/fragments/page/page-crud-actions.hbs }}
        </>
    );
}
