{{> fragment.header.hbs }}
// Page name: {{ page.name }}
// Page owner name: {{ page.owner.name }}
// Page DataElement name: {{ page.dataElement.name }}
// Page DataElement owner name: {{ page.dataElement.owner.name }}

import { useEffect, useState, useRef } from 'react';
import { useTranslation } from 'react-i18next';
import { Paper, Card, CardContent, Box, Grid, Button, Container } from '@mui/material';
import {
  MdiIcon,
  PageHeader,
} from '~/components';
import type { PersistedTableData, RefreshableTable } from '~/utilities';
import { useL10N } from '~/l10n/l10n-context';
import { PageActions } from './components/PageActions';
import { mainContainerPadding } from '~/theme';
{{# each page.originalPageContainer.tables as |table| }}
    import { {{ tableComponentName table }} } from './components/{{ tableComponentName table }}';
{{/ each }}

/**
 * Name: {{ page.name }}
 * Is Access: true
 * Is Dashboard: {{ boolValue page.isPageTypeDashboard }}
 * Type: Table
 **/
export default function {{ pageName page }}() {
    const persistedTableData: PersistedTableData = JSON.parse(
        window.sessionStorage.getItem('pages.{{ pageName page }}') || '{}',
    );
    const tableRef = useRef<RefreshableTable>(null);
    const { t } = useTranslation();
    const { locale: l10nLocale } = useL10N();
    const [isLoading, setIsLoading] = useState<boolean>(false);
    const title: string = t('{{ idToTranslationKey page.fQName application }}', { defaultValue: '{{ page.label }}' });

    const handleFetchData = async () => {
        tableRef.current?.fetchData();
    };

    {{# with (getTableForTablePage page) as |table| }}
        return (
            <>
                <PageHeader title={title}>
                    <PageActions fetchData={handleFetchData} isLoading={isLoading} />
                </PageHeader>
                <Container component="main" maxWidth="xl">
                    <Box sx={mainContainerPadding}>
                        <Grid container spacing={2}>
                            <Grid item xs={12}>
                                <Card>
                                    <CardContent id="{{ createId page }}-data-grid">
                                        <{{ tableComponentName table }}
                                            ref={ tableRef }
                                            isLoading={ isLoading }
                                            setIsLoading={ setIsLoading }
                                        />
                                    </CardContent>
                                </Card>
                            </Grid>
                        </Grid>
                    </Box>
                </Container>
            </>
        );
    {{/ with }}
}
